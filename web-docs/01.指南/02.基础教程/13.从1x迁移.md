---
title: "从1.x迁移"
date: "2022-02-26T10:44:53.000Z"
permalink: "/pages/base/upgrade2.x/"
---
# 准备工作

由于2.x重构了底层存储逻辑，1.x并不能直接升级至2.x版本，需要对存储结构做调整。

首先不要升级，启动项目后，在页面中，把所有接口、函数、数据源导出。


# 升级版本

将pom.xml中magic-api的版本号改为magic-api-lastest-version，随后重新启动项目

提示

由于2.x后台大量重构，所以有可能启动不起来，需要对代码进行调整。请看后续的非兼容变更


# 修改配置

为了防止升级失败，先建立一张与magic_api_file一样的表，起名为magic_api_file_v2

magic-api:
  resource:
    type: database
    table-name: magic_api_file_v2
    prefix: /magic-api


提示

如果使用其它存储方式的，建议将原来的数据进行备份。


# 导入旧版数据

启动成功后，在页面中将导出的zip压缩包全量上传



至此，版本升级完毕。


# 非兼容的变更

# 配置项变更

 * magic-api.response-code-config 变更为 magic-api.response-code
 * magic-api.backup-config 变更为 magic-api.backup
 * 移除magic-api.backup-config.resource-type配置，现在只能存数据库，不再支持选择
 * 新增magic-api.backup.enable配置，意为是否启用配置，默认为false
 * magic-api.crud-config 变更为 magic-api.crud
 * magic-api.cache-config 变更为 magic-api.cache
 * magic-api.page-config 变更为 magic-api.page
 * magic-api.security-config 变更为 magic-api.security
 * magic-api.swagger-config 变更为 magic-api.swagger
 * magic-api.debug-config 变更为 magic-api.debug
 * magic-api.cluster-config.instance-id 变更为 magic-api.instance-id
 * 移除magic-api.cluster-config配置，改为插件实现

# API变更

 * 集群、Redis、Mongo相关功能已改为插件实现。
 * 模块定义从实现MagicModule接口改为@MagicModule注解实现 详情请看 自定义模块
 * MagicAPIService移除存储相关API，改为MagicResourceService实现

# 其它变更

 * 前端目前不支持Vue方式直接引入，请改用 iframe方式 引入